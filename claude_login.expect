#!/usr/bin/expect -f

# Set timeout
set timeout 60

# Start claude
spawn claude

# Wait for prompt and send /login
expect {
    ">" {
        send "/login\r"
        exp_continue
    }
    "http*" {
        # Found URL, print it clearly
        puts "\nğŸ”¥ğŸ”¥ğŸ”¥ AUTHENTICATION URL FOUND ğŸ”¥ğŸ”¥ğŸ”¥"
        puts $expect_out(0,string)
        puts "ğŸ‘† Copy the URL above and open it in your browser"
        puts "ğŸ”„ After completing authentication, restart the Railway service"
        puts "ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"
        exp_continue
    }
    "success*" {
        puts "âœ… Authentication successful!"
        exit 0
    }
    "authenticated*" {
        puts "âœ… Authentication successful!"
        exit 0
    }
    timeout {
        puts "â° Authentication timed out"
        exit 1
    }
    eof {
        puts "âŒ Claude process ended"
        exit 1
    }
}

# Keep the script running to capture all output
interact